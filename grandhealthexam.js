totallist={},excelall=document.getElementById("excelall"),excelall.addEventListener("change",function(t){t.target.files[0]?(starttransferall(),excelall.value=""):alert("無選擇文件")});const importtxt=document.getElementById("importtxt");async function starttransfer(){try{tablebody=document.getElementById("reporttable").children[1],tablebody.innerHTML="",errmsg="",result=await readexcel1(),result||(errmsg+="新陳掛號檔錯誤\n"),result=await readexcel2(),result||(errmsg+="部彰報告檔錯誤\n"),result=await readexcel3(),result||(errmsg+="X光報告錯誤\n"),result=await readexcel4(),result||(errmsg+="FOBT檔錯誤\n"),result=await readexcel5(),result||(errmsg+="子抹檔錯誤\n"),result=await readexcel6(),result||(errmsg+="HP錯誤\n"),result=await readexcel7(),result||(errmsg+="PG錯誤\n"),result=await readexcel8(),result||(errmsg+="口篩錯誤\n"),result=await readexcel9(),result||(errmsg+="乳攝名冊錯誤\n"),result=await readexcel10(),result||(errmsg+="HBV DNA檔案錯誤\n"),showptable()}catch(t){alert(`${t.message}`)}}function readexcel1(){return new Promise((t,e)=>{if(excel1=document.getElementById("excel1"),excel1.files.length){const d=new FileReader;d.onload=function(e){const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);totallist={};for(let t=1;t<=n.e.r;t++)thenum=getxlsvalue(o[XLSX.utils.encode_cell({c:2,r:t})]),totallist[thenum]||(totallist[thenum]={}),totallist[thenum][0]=getxlsvalue(o[XLSX.utils.encode_cell({c:2,r:t})]),totallist[thenum][1]=getxlsvalue(o[XLSX.utils.encode_cell({c:0,r:t})]),totallist[thenum][2]=getxlsvalue(o[XLSX.utils.encode_cell({c:1,r:t})]),by=getxlsvalue(o[XLSX.utils.encode_cell({c:7,r:t})]),bm=getxlsvalue(o[XLSX.utils.encode_cell({c:8,r:t})]),bd=getxlsvalue(o[XLSX.utils.encode_cell({c:9,r:t})]),totallist[thenum][3]=by+"/"+bm+"/"+bd,totallist[thenum][4]=getxlsvalue(o[XLSX.utils.encode_cell({c:14,r:t})]),totallist[thenum][5]=getxlsvalue(o[XLSX.utils.encode_cell({c:10,r:t})]),totallist[thenum][6]=getxlsvalue(o[XLSX.utils.encode_cell({c:3,r:t})]),totallist[thenum][7]=getxlsvalue(o[XLSX.utils.encode_cell({c:16,r:t})]),totallist[thenum][8]=getxlsvalue(o[XLSX.utils.encode_cell({c:4,r:t})]),totallist[thenum][9]=getxlsvalue(o[XLSX.utils.encode_cell({c:6,r:t})]),town=getxlsvalue(o[XLSX.utils.encode_cell({c:11,r:t})]),village=getxlsvalue(o[XLSX.utils.encode_cell({c:12,r:t})]),address=getxlsvalue(o[XLSX.utils.encode_cell({c:13,r:t})]),totallist[thenum][10]=town+village+address;t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excel1.files[0])}else e(new Error("沒有新陳掛號檔"))})}function readexcel2(){return new Promise((t,e)=>{if(excel2=document.getElementById("excel2"),excel2.files.length){const d=new FileReader;d.onload=function(e){const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);for(let t=2;t<=n.e.r;t++)thenum=getxlsvalue(o[XLSX.utils.encode_cell({c:4,r:t})]),totallist[thenum]||(totallist[thenum]={}),totallist[thenum][11]=getxlsvalue(o[XLSX.utils.encode_cell({c:9,r:t})]),totallist[thenum][12]=getxlsvalue(o[XLSX.utils.encode_cell({c:10,r:t})]),totallist[thenum][13]=getxlsvalue(o[XLSX.utils.encode_cell({c:13,r:t})]),totallist[thenum][14]=getxlsvalue(o[XLSX.utils.encode_cell({c:14,r:t})]),totallist[thenum][15]=getxlsvalue(o[XLSX.utils.encode_cell({c:15,r:t})]),totallist[thenum][16]=getxlsvalue(o[XLSX.utils.encode_cell({c:16,r:t})]),totallist[thenum][17]=getxlsvalue(o[XLSX.utils.encode_cell({c:17,r:t})]),totallist[thenum][18]=getxlsvalue(o[XLSX.utils.encode_cell({c:18,r:t})]),totallist[thenum][19]=getxlsvalue(o[XLSX.utils.encode_cell({c:19,r:t})]),totallist[thenum][20]=getxlsvalue(o[XLSX.utils.encode_cell({c:20,r:t})]),totallist[thenum][21]=getxlsvalue(o[XLSX.utils.encode_cell({c:21,r:t})]),totallist[thenum][22]=getxlsvalue(o[XLSX.utils.encode_cell({c:22,r:t})]),totallist[thenum][23]=getxlsvalue(o[XLSX.utils.encode_cell({c:23,r:t})]),totallist[thenum][24]=getxlsvalue(o[XLSX.utils.encode_cell({c:24,r:t})]),totallist[thenum][25]=getxlsvalue(o[XLSX.utils.encode_cell({c:25,r:t})]),totallist[thenum][26]=getxlsvalue(o[XLSX.utils.encode_cell({c:26,r:t})]),totallist[thenum][27]=getxlsvalue(o[XLSX.utils.encode_cell({c:27,r:t})]),totallist[thenum][28]=getxlsvalue(o[XLSX.utils.encode_cell({c:28,r:t})]),totallist[thenum][29]=getxlsvalue(o[XLSX.utils.encode_cell({c:29,r:t})]),totallist[thenum][30]=getxlsvalue(o[XLSX.utils.encode_cell({c:30,r:t})]),totallist[thenum][31]=getxlsvalue(o[XLSX.utils.encode_cell({c:37,r:t})]),totallist[thenum][32]=getxlsvalue(o[XLSX.utils.encode_cell({c:38,r:t})]),totallist[thenum][33]=getxlsvalue(o[XLSX.utils.encode_cell({c:51,r:t})]),totallist[thenum][34]=getxlsvalue(o[XLSX.utils.encode_cell({c:50,r:t})]),totallist[thenum][35]=getxlsvalue(o[XLSX.utils.encode_cell({c:52,r:t})]),totallist[thenum][36]=getxlsvalue(o[XLSX.utils.encode_cell({c:53,r:t})]),totallist[thenum][37]=getxlsvalue(o[XLSX.utils.encode_cell({c:54,r:t})]),totallist[thenum][38]=getxlsvalue(o[XLSX.utils.encode_cell({c:55,r:t})]),totallist[thenum][39]=getxlsvalue(o[XLSX.utils.encode_cell({c:44,r:t})]),totallist[thenum][40]=getxlsvalue(o[XLSX.utils.encode_cell({c:45,r:t})]),totallist[thenum][41]=getxlsvalue(o[XLSX.utils.encode_cell({c:62,r:t})]),totallist[thenum][42]=getxlsvalue(o[XLSX.utils.encode_cell({c:58,r:t})]),totallist[thenum][43]=getxlsvalue(o[XLSX.utils.encode_cell({c:59,r:t})]),totallist[thenum][44]=getxlsvalue(o[XLSX.utils.encode_cell({c:60,r:t})]),totallist[thenum][45]=getxlsvalue(o[XLSX.utils.encode_cell({c:61,r:t})]),totallist[thenum][46]=getxlsvalue(o[XLSX.utils.encode_cell({c:40,r:t})]),totallist[thenum][47]=getxlsvalue(o[XLSX.utils.encode_cell({c:42,r:t})]),totallist[thenum][48]=getxlsvalue(o[XLSX.utils.encode_cell({c:82,r:t})]),totallist[thenum][49]=getxlsvalue(o[XLSX.utils.encode_cell({c:83,r:t})]),totallist[thenum][50]=getxlsvalue(o[XLSX.utils.encode_cell({c:84,r:t})]),totallist[thenum][51]=getxlsvalue(o[XLSX.utils.encode_cell({c:43,r:t})]),totallist[thenum][52]=getxlsvalue(o[XLSX.utils.encode_cell({c:41,r:t})]);t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excel2.files[0])}else t(!1)})}function readexcel3(){return new Promise((t,e)=>{if(excel3=document.getElementById("excel3"),excel3.files.length){const d=new FileReader;d.onload=function(e){const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);for(let t=2;t<=n.e.r;t++)thenum=getxlsvalue(o[XLSX.utils.encode_cell({c:4,r:t})]),totallist[thenum]||(totallist[thenum]={}),totallist[thenum][53]=getxlsvalue(o[XLSX.utils.encode_cell({c:12,r:t})]),totallist[thenum][54]=getxlsvalue(o[XLSX.utils.encode_cell({c:14,r:t})]),totallist[thenum][55]=getxlsvalue(o[XLSX.utils.encode_cell({c:15,r:t})]);t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excel3.files[0])}else t(!1)})}function readexcel4(){return new Promise((t,e)=>{if(excel4=document.getElementById("excel4"),excel4.files.length){const d=new FileReader;d.onload=function(e){const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);for(let t=2;t<=n.e.r;t++)thenum=getxlsvalue(o[XLSX.utils.encode_cell({c:2,r:t})]),totallist[thenum]||(totallist[thenum]={}),totallist[thenum][56]=getxlsvalue(o[XLSX.utils.encode_cell({c:8,r:t})]);t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excel4.files[0])}else t(!1)})}function readexcel5(){return new Promise((t,e)=>{if(excel5=document.getElementById("excel5"),excel5.files.length){const d=new FileReader;d.onload=function(e){const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);for(let t=1;t<=n.e.r;t++)thenum=getxlsvalue(o[XLSX.utils.encode_cell({c:2,r:t})]),totallist[thenum]||(totallist[thenum]={}),totallist[thenum][57]=getxlsvalue(o[XLSX.utils.encode_cell({c:16,r:t})]),totallist[thenum][58]=getxlsvalue(o[XLSX.utils.encode_cell({c:15,r:t})]);t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excel5.files[0])}else t(!1)})}function readexcel6(){return new Promise((t,e)=>{if(excel6=document.getElementById("excel6"),excel6.files.length){const d=new FileReader;d.onload=function(e){const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);for(let t=1;t<=n.e.r;t++)thenum=getxlsvalue(o[XLSX.utils.encode_cell({c:0,r:t})]),totallist[thenum]||(totallist[thenum]={}),totallist[thenum][59]=getxlsvalue(o[XLSX.utils.encode_cell({c:9,r:t})]);t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excel6.files[0])}else t(!1)})}function readexcel7(){return new Promise((t,e)=>{if(excel7=document.getElementById("excel7"),excel7.files.length){const d=new FileReader;d.onload=function(e){const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);for(let t=1;t<=n.e.r;t++)thenum=getxlsvalue(o[XLSX.utils.encode_cell({c:3,r:t})]),totallist[thenum]||(totallist[thenum]={}),totallist[thenum][60]=getxlsvalue(o[XLSX.utils.encode_cell({c:13,r:t})]),totallist[thenum][61]=getxlsvalue(o[XLSX.utils.encode_cell({c:7,r:t})]),totallist[thenum][62]=getxlsvalue(o[XLSX.utils.encode_cell({c:9,r:t})]);t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excel7.files[0])}else t(!1)})}function readexcel8(){return new Promise((t,e)=>{if(excel8=document.getElementById("excel8"),excel8.files.length){const d=new FileReader;d.onload=function(e){const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);oralids=[];for(let t=3;t<=n.e.r;t++)oralid=getxlsvalue(o[XLSX.utils.encode_cell({c:4,r:t})]),""!=oralid&&oralids.push(oralid);for(numlist=Object.keys(totallist),ni=0;ni<numlist.length;ni++)numlistid=totallist[numlist[ni]][1],thenum=totallist[numlist[ni]][0],oralids.includes(numlistid)?(totallist[thenum]||(totallist[thenum]={}),totallist[thenum][63]="已做"):(totallist[thenum]||(totallist[thenum]={}),totallist[thenum][63]="");t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excel8.files[0])}else t(!1)})}function readexcel9(){return new Promise((t,e)=>{if(excel9=document.getElementById("excel9"),excel9.files.length){const d=new FileReader;d.onload=function(e){const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);for(let t=1;t<=n.e.r;t++)thenum=getxlsvalue(o[XLSX.utils.encode_cell({c:0,r:t})]),totallist[thenum]||(totallist[thenum]={}),totallist[thenum][64]=getxlsvalue(o[XLSX.utils.encode_cell({c:9,r:t})]),totallist[thenum][65]=getxlsvalue(o[XLSX.utils.encode_cell({c:10,r:t})]);t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excel9.files[0])}else t(!1)})}function readexcel10(){return new Promise((t,e)=>{if(excel10=document.getElementById("excel10"),excel10.files.length){const d=new FileReader;d.onload=function(e){const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);for(let t=1;t<=n.e.r;t++)thenum=getxlsvalue(o[XLSX.utils.encode_cell({c:2,r:t})]),totallist[thenum]||(totallist[thenum]={}),totallist[thenum][66]=getxlsvalue(o[XLSX.utils.encode_cell({c:6,r:t})]);t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excel10.files[0])}else t(!1)})}function showptable(){for(numlist=Object.keys(totallist),tablebody=document.getElementById("reporttable").children[1],ggg=0,tbr=0;tbr<numlist.length;tbr++)if(13==numlist[tbr].length)for(ggg+=1,row=tablebody.insertRow(),row.onclick=function(){var t=document.querySelector(".highlight");t&&t.classList.remove("highlight"),this.classList.add("highlight")},tbc=0;tbc<=66;tbc++)cell=row.insertCell(),null==totallist[numlist[tbr]][tbc]?cell.textContent="":cell.textContent=totallist[numlist[tbr]][tbc];document.getElementById("endnum").value=ggg}function readexcelall(){return new Promise((t,e)=>{if(excelall=document.getElementById("excelall"),excelall.files.length){const d=new FileReader;d.onload=function(e){totallist={};const d=new Uint8Array(e.target.result),l=XLSX.read(d,{type:"array"}),r=l.SheetNames[0],o=l.Sheets[r],n=XLSX.utils.decode_range(o["!ref"]);for(let t=1;t<=n.e.r;t++)for(thenum=getxlsvalue(o[XLSX.utils.encode_cell({c:0,r:t})]),totallist[thenum]||(totallist[thenum]={}),C=0;C<=66;C++)totallist[thenum][C.toString()]=getxlsvalue(o[XLSX.utils.encode_cell({c:C,r:t})]);t(!0)},d.onerror=function(){e(new Error("讀取錯誤"))},d.readAsArrayBuffer(excelall.files[0])}else t(!1)})}async function starttransferall(){try{tablebody=document.getElementById("reporttable").children[1],tablebody.innerHTML="",errmsg="",result=await readexcelall(),result||(errmsg+="總表錯誤\n"),showptable()}catch(t){alert(`${t.message}`)}}function exportToExcel(){const t=document.getElementById("reporttable");let e=XLSX.utils.table_to_sheet(t,{raw:!0});for(let t in e)t.startsWith("!")||(e[t].t="s");const d=XLSX.utils.book_new();XLSX.utils.book_append_sheet(d,e,"Sheet1");const l=XLSX.write(d,{bookType:"xlsx",type:"array"}),r=new Blob([l],{type:"application/octet-stream"}),o=URL.createObjectURL(r),n=document.createElement("a");n.href=o,n.download="總表匯出.xlsx",n.click(),URL.revokeObjectURL(o)}function granfromtable(){for(tablebody=document.getElementById("reporttable").children[1],grabobj={},i=0;i<tablebody.rows.length;i++)for(thenum=tablebody.rows[i].cells[0].textContent,grabobj[thenum]={},j=0;j<=66;j++)grabobj[thenum][j.toString()]=tablebody.rows[i].cells[j].textContent;return grabobj}function exportToPDF(){reportlist=granfromtable(),reportlistkey=Object.keys(reportlist),startnum=document.getElementById("startnum"),endnum=document.getElementById("endnum"),sv=startnum.value,ev=endnum.value,errmsg=checkbasic(),1*sv>reportlistkey.length?errmsg+="起始編號過大\n":1*sv>0?(v0=1*sv-1,1*ev>reportlistkey.length?v1=reportlistkey.length:v1=1*ev):errmsg+="起始編號異常\n",document.getElementById("checkchecklist").checked||document.getElementById("checkreport").checked||document.getElementById("checksmoke").checked||document.getElementById("checktransfer").checked||(errmsg+="請至少選擇一種項目匯出\n"),""==errmsg?convertToPDF(v0,v1,cn,cc,cp,ca,dn,ds,etv1,etv2):alert(errmsg)}function convertToPDF(t,e,d,l,r,o,n,a,c,s){for(clinicname=d,cliniccode=l,clinicphone=r,clinicaddress=o,doctorname=n,doctorsp=a,explaintime=c,expiretime=s,reportcontent=addtitle("報告匯出"),i=t;i<e;i++)dat=reportlist[reportlistkey[i]],document.getElementById("checkchecklist").checked&&(reportcontent+='<div class="checklist_title">'+clinicname+"整篩報告check list</div>",reportcontent+='<table class="checklist_table_1"><tr><td colspan="2">整篩編號 :'+dat[0]+"</td>","21"==dat[7]?temp="23":"22"==dat[7]?temp="24":"25"==dat[7]?temp="26":"27"==dat[7]?temp="28":temp="60",reportcontent+="<td>【掛號碼："+temp+"】</td></tr>",reportcontent+="<tr><td>姓　　名 : "+dat[2]+"</td><td>身 分 證 : "+dat[1]+"</td><td>生　　日 : "+dat[3]+"</td></tr>",reportcontent+="<tr><td>電　　話 : "+dat[8]+"</td><td>手　　機 : "+dat[9]+"</td><td></td></tr></table>",reportcontent+='<table class="checklist_table_2"><tr><th>項目</th><th>結果</th><th>處置</th><th>備註</th></tr>',1*dat[11]>130||1*dat[12]>80?(temp="✱",temp2="衛教單"):(temp="　",temp2="X"),reportcontent+='<tr><td>血壓</td><td>　<span class="checklist_table_value">'+temp+dat[11]+"/"+dat[12]+"　</span>mmHg</td><td>"+temp2+"</td><td>□已就醫，院所：</td></tr>","有"==dat[22]?(temp="■是 □否 □已戒菸",temp2="■戒菸建議書"):"已戒菸"==dat[22]?(temp="□是 □否 ■已戒菸",temp2="□戒菸建議書"):(temp="□是 ■否 □已戒菸",temp2="□戒菸建議書"),reportcontent+="<tr><td>抽菸</td><td>"+temp+"</td><td>X</td><td>"+temp2+"</td></tr>",1*dat[31]>100?temp="✱":temp="　",1*dat[32]>=6.5?temp2="✱":temp2="　","✱"==temp||"✱"==temp2?temp3="衛教單":temp3="X",reportcontent+='<tr><td>血糖</td><td>空 腹 血 糖:<span class="checklist_table_value">'+temp+dat[31]+'　</span><br> 糖化血色素 :<span class="checklist_table_value">'+temp2+dat[32]+"　</span></td><td>"+temp3+"</td><td>□已就醫，院所：</td></tr>",["第4期","第5期"].includes(dat[51])?(t0="✱",temp2="轉診單"):["第1期","第2期","第3a期","第3b期"].includes(dat[51])?(t0="✱",temp2="衛教單"):(t0="",temp2="X"),1*dat[47]<60?t1="✱":t2="","因數值超出線性，無法計算比值。"==dat[50]?temp="尿蛋白<6":1*dat[50]>150?temp="✱"+dat[50]:temp=dat[50],reportcontent+="<tr><td>慢性腎臟病(CKD)</td><td>"+t0+dat[51]+'，eGFR:<span class="checklist_table_value">'+t2+dat[47]+'</span><br>UPCR:<span class="checklist_table_value">'+temp+"</span></td><td>"+temp2+"</td><td>□已就醫，院所：</td></tr>",1*dat[33]>200?t0="✱"+dat[33]:t0="　"+dat[33],1*dat[34]>150?t1="✱"+dat[34]:t1="　"+dat[34],"男"==dat[5]?1*dat[35]<40?t2="✱"+dat[35]:t2="　"+dat[35]:1*dat[35]<50?t2="✱"+dat[35]:t2="　"+dat[35],1*dat[36]>130?t3="✱"+dat[36]:t3="　"+dat[36],tall=t0+t1+t2+t3,tall.includes("✱")?t4="衛教單":t4="X",reportcontent+='<tr><td>血脂肪</td><td>T C:<span class="checklist_table_value">'+t0+'　</span><br>T G:<span class="checklist_table_value">'+t1+'　</span><br>HDL:<span class="checklist_table_value">'+t2+'　</span><br>LDL:<span class="checklist_table_value">'+t3+"　</span></td><td>"+t4+"</td><td>□已就醫，院所：</td></tr>","陽性"==dat[42]?(t0="■陽性 □陰性 □舊陽性",t1="轉診單"):"陰性"==dat[42]?(t0="□陽性 ■陰性 □舊陽性",t1="X"):"先前驗過為陽性，此次未再檢驗"==dat[42]?(t0="□陽性 □陰性 ■舊陽性",t1="轉診單"):(t0="□陽性 □陰性 □舊陽性",t1="X"),reportcontent+="<tr><td>B肝</td><td>"+t0+"</td><td>"+t1+'</td><td rowspan="3">□衛生所肝超，時間:<br>　___月___日___點___分<br>□自行就醫　:________<br>□原就醫診所:________</td></tr>',"陽性"==dat[44]?(t0="■陽性 □陰性 □舊陽性",t1="轉診單"):"陰性"==dat[44]?(t0="□陽性 ■陰性 □舊陽性",t1="X"):"先前驗過為陽性，此次未再檢驗"==dat[44]?(t0="□陽性 □陰性 ■舊陽性",t1="轉診單"):(t0="□陽性 □陰性 □舊陽性",t1="X"),reportcontent+="<tr><td>C肝</td><td>"+t0+"</td><td>"+t1+"</td></tr>",1*dat[41]>9?(t0="✱"+dat[41],t1="轉診單"):(t0="　"+dat[41],t1="X"),reportcontent+='<tr><td>AFP</td><td><span class="checklist_table_value">'+t0+"　</span>ng/dL</td><td>"+t1+"</td></tr>",""!=dat[54]?t1="轉診單":t1="X",reportcontent+="<tr><td>胸部X光</td><td>"+dat[53]+"</td><td>"+t1+"</td><td>□已就醫，院所：</td></tr><tr><td>驗痰</td><td>　"+dat[55]+"　</td><td>X</td><td></td></tr>","陽性"==dat[56]?(t0="■陽性 □陰性 □未做",t1="轉診單"):"陰性"==dat[56]?(t0="□陽性 ■陰性 □未做",t1="X"):(t0="□陽性 □陰性 ■未做",t1="X"),reportcontent+="<tr><td>糞便潛血(FOBT)</td><td>"+t0+"</td><td>"+t1+"</td><td>□已就醫，院所：</td></tr>","陽性"==dat[59]?(t0="■陽性 □陰性 □未做",t1="轉診單"):"陰性"==dat[59]?(t0="□陽性 ■陰性 □未做",t1="X"):(t0="□陽性 □陰性 ■未做",t1="X"),reportcontent+="<tr><td>幽門桿菌(HP)</td><td>"+t0+"</td><td>"+t1+"</td><td>□已就醫，院所：</td></tr>","陽性"==dat[60]?(t0="■陽性 □陰性 □未做",t1="轉診單"):"陰性"==dat[60]?(t0="□陽性 ■陰性 □未做",t1="X"):(t0="□陽性 □陰性 ■未做",t1="X"),reportcontent+="<tr><td>胃蛋白酶(PG)</td><td>"+t0+"</td><td>"+t1+"</td><td>□已就醫，院所：</td></tr>","男"==dat[5]?(t0="N/A",t1="X"):""==dat[57]?(t0="未做",t1="X"):(papcode=dat[58],t0="【"+dat[57]+"】"+papcodelist[papcode],["1","2","3"].includes(papcode)?t1="衛教單":"21"==papcode?t1="重抹":t1="轉診單"),reportcontent+="<tr><td>子宮頸抹片</td><td>"+t0+"</td><td>"+t1+"</td><td>□已就醫，院所：</td></tr></table>",reportcontent+='</table><table class="checklist_table_3"><tr><td style="text-align: center;">乳攝</td>',"男"==dat[5]?(t0="N/A",t1="□可做篩檢　■資格不符"):""==dat[64]?(t0=dat[65],t1="□可做篩檢　■資格不符"):"首篩"==dat[64]?(t0="首篩",t1="■可做篩檢　□資格不符"):(t0=dat[65],t1="■可做篩檢　□資格不符"),reportcontent+="<td>最近一次篩檢<br>日期:<span>　"+t0+"　</span></td><td>二階日期: <span>"+explaintime+"</span>預約時間: <br><span>"+t1+"</span></td></tr>",tcount=0,""!=dat[56]?(t0="■FOBT",tcount+=1):t0="□FOBT",""!=dat[63]?(t1="■口篩",tcount+=1):t1="□口篩",reportcontent+='<tr><td colspan="3">備註:<br>1. 禮卷:<span>□乳 '+t0+" "+t1+" □子抹，共 "+tcount+" 張</span><br>2. <span>□問卷補資料</span><br>3. 其他:<br><br><br></td></tr></table>",reportcontent+='<br><div class="checklist_sign">解說醫師簽章:__________________　　　　領取報告及禮券簽章:__________________</div>\t<div class="page-break2"></div><div class="page-break"></div>'),document.getElementById("checkreport").checked&&(reportcontent+='<br><span class="checklist_uppertitle">編號:'+dat[0]+"　　姓名:"+dat[2]+'</span><br><br><br><br><br><br><div class="checklist_middletitle">113年萬人健康檢查<br><br>'+clinicname+"<br><br>衛教及轉診說明書<br><br></div>",reportcontent+='<div class="checklist_content">問卷編號:<span>'+dat[0]+"</span></div>",reportcontent+='<div class="checklist_content">姓　　名:<span>'+dat[2]+"</span></div>",reportcontent+='<div class="checklist_content">檢查日期:<span>'+dat[6]+'</span></div><br><div class="checklist_splitline">------------------若有疑問請洽------------------</div><div class="checklist_content">電　　話:<span> '+clinicphone+'</span></div><br><div class="checklist_content">護理人員:</div><br><br><br><br><div class="checklist_splitline">彰化縣衛生局關心您</div>',reportcontent+='<div class="page-break2"></div><div class="page-break"></div>',reportcontent+='<div class="report_title">健康檢查報告(第一頁)</div><table class="report_table">',reportcontent+='<tr><td colspan="3">整篩編號:<span>'+dat[0]+"</span></td><td>姓名:<span>"+dat[2]+"</span></td></tr>",reportcontent+='<tr><td class="report_table_underline">中文名稱</td><td class="report_table_underline">英文名稱</td><td class="report_table_underline">檢驗值</td><td class="report_table_underline">參考值</td></tr>',reportcontent+='<tr><td colspan="4" class="report_table_title">體格檢查</td></tr>',t0=addcomment(dat[11],130,90,!0),reportcontent+='<tr><td class="report_table_subtitle">收縮壓</td><td>Systolic pressure</td><td>'+t0+"</td><td>90~130 mmHg</td></tr>",t0=addcomment(dat[12],80,60,!0),reportcontent+='<tr><td class="report_table_subtitle">舒張壓</td><td>Diastolic pressure</td><td>'+t0+"</td><td>60~80 mmHg</td></tr>",reportcontent+='<tr><td class="report_table_subtitle">身高</td><td>Height</td><td>'+dat[13]+"</td><td></td></tr>",reportcontent+='<tr><td class="report_table_subtitle">體重</td><td>Weight</td><td>'+dat[14]+"</td><td></td></tr>",t0=addcomment(dat[15],24,18.5,!0),t0.includes("✱")||(idealweight=Math.round(22*dat[13]*dat[13]/1e4),1*dat[15]>=27?t0=t0+"，肥胖<br>理想體重"+idealweight+"公斤":1*dat[15]>=24&&1*dat[15]<27?t0=t0+"，過重<br>理想體重"+idealweight+"公斤":1*dat[15]>=18.5&&1*dat[15]<24?t0=t0+"，正常<br>理想體重"+idealweight+"公斤":1*dat[15]<18.5&&(t0=t0+"，過輕<br>理想體重"+idealweight+"公斤")),reportcontent+='<tr><td class="report_table_subtitle">身體質量指數</td><td>Body mass index</td><td><span>'+t0+"</span></td><td>18.5~24 kg/m2</td></tr>","男"==dat[5]?t0=addcomment(dat[16],90,0,!0):t0=addcomment(dat[16],80,0,!0),reportcontent+='<tr><td class="report_table_subtitle">腰圍</td><td>Wiastline</td><td>'+t0+"</td><td>男性:≦90公分<br>女性:≦80公分</td></tr>",t0=addcomment(dat[17],100,60,!0),reportcontent+='<tr><td class="report_table_subtitle">脈搏</td><td>Pulse rate</td><td>'+t0+"</td><td>60~100次/分</td></tr>",""!==dat[18]?t0=addcomment(dat[18],2,.6,!0):t0="未測量",""!==dat[19]?t1=addcomment(dat[19],2,.6,!0):t1="未測量",""!==dat[20]?t2=addcomment(dat[20],2,.6,!0):t2="未測量",""!==dat[21]?t3=addcomment(dat[21],2,.6,!0):t3="未測量",reportcontent+='<tr><td colspan="4" class="report_table_title">眼科檢查</td></tr>',reportcontent+='<tr><td class="report_table_subtitle">裸視(右眼)</td><td>Naked eye [R\'t]</td><td>'+t0+"</td><td>0.6~2.0</td></tr>",reportcontent+='<tr><td class="report_table_subtitle">裸視(左眼)</td><td>Naked eye [L\'t]</td><td>'+t1+"</td><td>0.6~2.0</td></tr>",reportcontent+='<tr><td class="report_table_subtitle">校正(右眼)</td><td>Naked eye [R\'t]</td><td>'+t2+"</td><td>0.6~2.0</td></tr>",reportcontent+='<tr><td class="report_table_subtitle">校正(左眼)</td><td>Naked eye [L\'t]</td><td>'+t3+"</td><td>0.6~2.0</td></tr>",reportcontent+='<tr><td class="report_table_title" style="text-align: center;">抽菸習慣</td><td></td><td>'+dat[22]+"</td><td></td></tr>",reportcontent+='<tr><td colspan="4" class="report_table_title">血液常規檢查</td></tr>',t0=addcomment(dat[23],10,3,!0),reportcontent+='<tr><td class="report_table_subtitle">白血球計數</td><td>WBC count</td><td>'+t0+"</td><td>3~10 x 10^3/uL</td></tr>",t0=addcomment(dat[24],10,3.8,!0),reportcontent+='<tr><td class="report_table_subtitle">紅血球計數</td><td>RBC count</td><td>'+t0+"</td><td>3.8~6 x 10^6/uL</td></tr>",t0=addcomment(dat[25],16,12,!0),reportcontent+='<tr><td class="report_table_subtitle">血色素</td><td>Hemoglobin</td><td>'+t0+"</td><td>12~16 g/dL</td></tr>",t0=addcomment(dat[26],46.9,33.5,!0),reportcontent+='<tr><td class="report_table_subtitle">血球容積比</td><td>Hematocrite</td><td>'+t0+"</td><td>33.5~46.9 %</td></tr>",t0=addcomment(dat[27],33,25.8,!0),reportcontent+='<tr><td class="report_table_subtitle">平均血紅素量</td><td>MCH</td><td>'+t0+"</td><td>25.8~33.0 pg</td></tr>",t0=addcomment(dat[28],100,80,!0),reportcontent+='<tr><td class="report_table_subtitle">紅血球平均體積</td><td>MCV</td><td>'+t0+"</td><td>80~100 fL</td></tr>",t0=addcomment(dat[29],34.2,31.8,!0),reportcontent+='<tr><td class="report_table_subtitle">平均血色素濃度</td><td>MCHC</td><td>'+t0+"</td><td>31.8~34.2 g/dL</td></tr>",t0=addcomment(dat[30],413,169,!0),reportcontent+='<tr><td class="report_table_subtitle">血小板計數</td><td>Platelet count</td><td>'+t0+"</td><td>169~413 10^3/µL</td></tr>",reportcontent+='<tr><td colspan="4" class="report_table_title">血糖檢查</td></tr>',t0=addcomment(dat[31],100,70,!0),reportcontent+='<tr><td class="report_table_subtitle">飯前血糖檢查</td><td>Glucose(AC)</td><td>'+t0+"</td><td>70~100 mg/dL<br>≥126 則懷疑糖尿病</td></tr>",t0=addcomment(dat[32],5.6,4.7,!0),reportcontent+='<tr><td class="report_table_subtitle">醣化血色素</td><td>HbA1C</td><td>'+t0+"</td><td>4.7~5.6 %<br>≥6.5 則懷疑糖尿病</td></tr>",reportcontent+='<tr><td colspan="4" class="report_table_title">血脂肪檢查</td></tr>',t0=addcomment(dat[33],200,0,!0),reportcontent+='<tr><td class="report_table_subtitle">血清總膽固醇</td><td>Total cholesterol</td><td>'+t0+"</td><td><200 mg/dL</td></tr>",t0=addcomment(dat[34],150,0,!0),reportcontent+='<tr><td class="report_table_subtitle">三酸甘油脂</td><td>Triglyceride</td><td>'+t0+"</td><td><150 mg/dL</td></tr>","男"==dat[5]?t0=addcomment(dat[35],0,40,!0):t0=addcomment(dat[35],0,50,!0),reportcontent+='<tr><td class="report_table_subtitle">高密度膽固醇(好)</td><td>HDL-cholesterol</td><td>'+t0+"</td><td>男性:≥40 mg/dL<br>女性:≥50 mg/dL</td></tr>",t0=addcomment(dat[36],130,0,!0),reportcontent+='<tr><td class="report_table_subtitle">低密度膽固醇(壞)</td><td>LDL-cholesterol</td><td>'+t0+"</td><td><130 mg/dL<br>若糖尿病則<100</td></tr>",reportcontent+="</table>",reportcontent+='<div class="page-break2"></div><div class="page-break"></div>',reportcontent+='<div class="report_title">健康檢查報告(第二頁)</div><table class="report_table">',reportcontent+='<tr><td colspan="3">整篩編號:<span>'+dat[0]+"</span></td><td>姓名:<span>"+dat[2]+"</span></td></tr>",reportcontent+='<tr><td class="report_table_underline">中文名稱</td><td class="report_table_underline">英文名稱</td><td class="report_table_underline">檢驗值</td><td class="report_table_underline">參考值</td></tr>',reportcontent+='<tr><td colspan="4" class="report_table_title">肝功能、病毒性肝炎、肝臟腫瘤標記檢查</td></tr>',t0=addcomment(dat[39],40,0,!0),reportcontent+='<tr><td class="report_table_subtitle">草酸轉胺基酶(肝)</td><td>AST(GOT)</td><td>'+t0+"</td><td>≤40 mg/dL</td></tr>",t0=addcomment(dat[40],40,0,!0),reportcontent+='<tr><td class="report_table_subtitle">丙酮轉胺基酶(肝)</td><td>ALT(GPT)</td><td>'+t0+"</td><td>≤40 mg/dL</td></tr>",dat[42].includes("陽性")?t0=dat[42]+"*":t0=dat[42],isNaN(1*dat[43])?t1="":t1=dat[43],reportcontent+='<tr><td class="report_table_subtitle">B肝表面抗原(定性)</td><td>HBsAg</td><td>'+t0+"</td><td>陰性</td></tr>",""!=t1&&(t1=addcomment(t1,1,0,!0)),reportcontent+='<tr><td class="report_table_subtitle">B肝表面抗原(定量)</td><td>HBsAg</td><td>'+t1+"</td><td><1 S/CO</td></tr>",""!=dat[66]&&"未操作"!=dat[66]&&("Target not detected"!=dat[66]?t1=dat[66]+"*":t1="未檢出",reportcontent+='<tr><td class="report_table_subtitle">B肝病毒量</td><td>HBV viral load</td><td>'+t1+"</td><td><未檢出</td></tr>"),dat[44].includes("陽性")?t0=dat[44]+"*":t0=dat[44],isNaN(1*dat[45])?t1="":t1=dat[45],""!=t1&&(t1=addcomment(t1,1,0,!0)),reportcontent+='<tr><td class="report_table_subtitle">C肝抗體(定性)</td><td>Anti-HCV</td><td>'+t0+"</td><td>陰性</td></tr>",reportcontent+='<tr><td class="report_table_subtitle">C肝抗體(定量)</td><td>Anti-HCV</td><td>'+t1+"</td><td><1.5 S/CO</td></tr>",t0=addcomment(dat[41],9,0,!0),reportcontent+='<tr><td class="report_table_subtitle">甲型胎兒蛋白(肝癌)</td><td>α-fetoprotein</td><td>'+t0+"</td><td><9.00 ng/mL</td></tr>",reportcontent+='<tr><td colspan="4" class="report_table_title">腎功能、蛋白尿檢查</td></tr>',t0=addcomment(dat[46],1.3,.4,!0),reportcontent+='<tr><td class="report_table_subtitle">肌酸酐</td><td>Creatinine</td><td>'+t0+"</td><td>0.4~1.3 mg</td></tr>",t0=addcomment(dat[47],0,60,!0),reportcontent+='<tr><td class="report_table_subtitle">腎絲球過濾率</td><td>eGFR</td><td>'+t0+"</td><td>>60 ml/min/1.73m^2</td></tr>","<6.00"==dat[48]?t0=dat[48]:t0=addcomment(dat[48],10,0,!0),reportcontent+='<tr><td class="report_table_subtitle">尿液總蛋白質</td><td>Urine protein</td><td>'+t0+"</td><td><10 mg/dL</td></tr>",t0=addcomment(dat[49],250,60,!0),reportcontent+='<tr><td class="report_table_subtitle">尿液肌酸酐</td><td>Urine creatinine</td><td>'+t0+"</td><td>60~250 mg/dL</td></tr>",dat[50].includes("超出線性")?t0="尿蛋白<6，不需計算":t0=addcomment(dat[50],150,0,!0),reportcontent+='<tr><td class="report_table_subtitle">尿液蛋白質/肌酸酐</td><td>UPCR</td><td>'+t0+"</td><td><150 mg/g</td></tr>","正常"!=dat[51]?t0=dat[51]+"*":t0=dat[51],reportcontent+='<tr><td class="report_table_subtitle">慢性腎臟病期數</td><td>CKD stage</td><td>'+t0+"</td><td>正常</td></tr>",t0=addcomment(dat[52],7,0,!0),reportcontent+='<tr><td class="report_table_subtitle">尿酸</td><td>Uric acid</td><td>'+t0+"</td><td><7mg/dL</td></tr>",reportcontent+='<tr><td colspan="4" class="report_table_title">肺結核篩檢</td></tr>',reportcontent+='<tr><td class="report_table_subtitle">胸部X光檢查</td><td>Chest X-ray</td><td>'+dat[53]+"</td><td>無活動性肺結核病灶</td></tr>","男"==dat[5]?(t0="男性不須抹片",t1=""):""==dat[57]?(t0="未做",t1="*"):(papcode=dat[58],t0="【"+dat[57]+"】"+papcodelist[papcode],["1","2","3"].includes(papcode)?t1="":t1="*"),reportcontent+='<tr><td class="report_table_title" style="text-align: left;">子宮頸抹片</td><td>Pap smear</td><td>'+t0+"</td><td>正常或編號≤3</td></tr>",""==dat[56]?t0="未做":"陽性"==dat[56]?t0=dat[56]+"*":t0=dat[56],reportcontent+='<tr><td class="report_table_title" style="text-align: left;">糞便潛血</td><td>FOBT</td><td>'+t0+"</td><td>陰性</td></tr>",""==dat[59]?t0="未做":"陽性"==dat[59]?t0=dat[59]+"*":t0=dat[59],reportcontent+='<tr><td class="report_table_title" style="text-align: left;">幽門桿菌抗原</td><td>Helicobacter pylori antigen</td><td>'+t0+"</td><td>陰性</td></tr>",reportcontent+='<tr><td colspan="4" class="report_table_title">胃蛋白酶原檢驗</td></tr>',""==dat[60]?t0="未做":"陽性"==dat[60]?t0=dat[60]+"*":t0=dat[60],reportcontent+='<tr><td class="report_table_subtitle">胃蛋白酶原檢驗結果</td><td>Pepsinogen Test</td><td>'+t0+"</td><td>PG I ≥70 或<br>PG I/II 比值≥3</td></tr>",""==dat[61]?t0="未做":t0=addcomment(dat[61],0,70,!0),reportcontent+='<tr><td class="report_table_subtitle">胃蛋白酶I</td><td>Pepsinogen(PG) I</td><td>'+t0+"</td><td>≥70ng/mL</td></tr>",""==dat[62]?t0="未做":t0=addcomment(dat[62],0,3,!0),reportcontent+='<tr><td class="report_table_subtitle">胃蛋白酶I/II比值</td><td>PG I/II ratio</td><td>'+t0+"</td><td>≥3</td></tr>",reportcontent+="</table>",reportcontent+='<div class="page-break2"></div><div class="page-break"></div>',reportcontent+='<div class="suggestion_title">彰化縣'+clinicname+"整合式篩檢衛教單(1/2)</div>",reportcontent+='<div><table class="suggestion_table1"><tr><td>整篩編號：'+dat[0]+"</td><td>姓名："+dat[2]+"</td></tr></table></div>",reportcontent+='<div><table class="suggestion_table2"><tr><th></th><th>項目</th><th>說明</th></tr>',"男"==dat[5]&&1*dat[16]>=90||"女"==dat[5]&&1*dat[16]>=80||1*dat[15]>=24?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">體重腰圍</td><td>1. 生活型態調整：減少高糖、高油脂、高熱量食物攝取，避免食用正餐時間外的零食，增加運動量，培養運動習慣。<br>2. 每周監測體重及腰圍：透過定時監測體重了解控制成果及增加警覺，可更增加減重效益。</td></tr>',1*dat[11]>130||1*dat[12]>80?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">血壓偏高</td><td>1. 生活型態調整：SABCDE策略，少鹽(S)、限酒(A)、減重(B)、戒菸(C)、飲食調整(D)和運動(E)。<br>2. 722量血壓：「7」連續七天量測、「2」起床、睡前各量一次、「2」每次量兩遍，若超過130/80mmHg則建議就醫。</td></tr>',1*dat[31]>100||1*dat[32]>5.6?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">血糖偏高</td><td>1. 生活型態調整：多運動，均衡飲食，定時定量，多選用富含纖維質的食物，少吃富含精緻糖類的食品(糖果、煉乳、中西式甜點心)並。<br>2. 生活型態調整後3~6個月請再次抽血追蹤(需空腹)。</td></tr>',1*dat[25]<12?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">貧血</td><td>1. 貧血原因十分多樣，需針對個別原因進行處理，以下提供兩個常見類型的衛教，若仍有疑問可前往血液腫瘤科進行諮詢。<br> a.若為有月經婦女最常見原因為缺鐵性貧血，可多補充富含鐵質食物，也可至婦產科檢查是否子宮問題導致經血量較大。<br> b.地中海型貧血屬於遺傳性的貧血，佔台灣總人口數的6至8%左右，可在孕前做健康檢查，避免雙方皆是帶因者，而生出重症地中海型貧血的孩子。</td></tr>',1*dat[33]>200||1*dat[34]>150||1*dat[36]>130||"男"==dat[5]&&1*dat[35]<40||"女"==dat[5]&&1*dat[35]<50?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">血脂肪偏高</td><td>1. 生活型態調整：多運動，避免吃富含膽固醇或油脂食物(內臟、帶殼海鮮、肥肉)，多攝取富含纖維質的食物(各種蔬菜、全榖雜糧)，選用少油的烹調方式，避免煎炸並戒酒。<br>2. 生活型態調整後3~6個月請再次抽血追蹤(需空腹)。</td></tr>',dat[51].includes("期")?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">腎功能異常</td><td>1. 生活型態調整：多攝取水份，避免吃高鈉或過度加工食物(醃漬品、各式罐頭)，避免使用來不明的成藥、中草藥、電台藥物或保健食品，避免使用傷腎藥物(消炎止痛藥)。<br>2. 生活型態調整後3~6個月請再次抽血驗尿追蹤(不需空腹)。</td></tr>',1*dat[52]>7?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">尿酸過高</td><td>1. 生活型態調整：多攝取水份，避免吃高普林食物(如內臟類、帶殼海鮮、濃湯等)、高果糖食物(大量水果或含糖飲料)及避免喝酒。<br>2. 若有發作頻繁痛風可與醫師討論是否降尿酸治療。<br>3. 生活型態調整後3~6個月請再次抽血驗尿追蹤(需空腹)。</td></tr>',1*dat[39]>40||1*dat[40]>40?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">肝功能異常</td><td>1. 生活型態調整：避免菸酒，維持理想體重，少吃發酵、煙漬食物，作息正常，避免使用來不明的成藥、中草藥、電台藥物或保健食品。<br>2. 生活型態調整後3~6個月請再次抽血驗尿追蹤(不需空腹)。</td></tr>',dat[42].includes("陽性")?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">B型肝炎</td><td rowspan="2">1. 阻斷傳染途徑：避免共用針頭、牙刷、刮鬍刀等<br>2. 健康飲食及多運動，保持良好的生活習慣，勿飲酒。<br>3. B型肝炎帶原者: 每半年定期肝膽腸胃科腹部超音波及抽血檢查。<br>4. C型肝炎抗體陽性: 表示曾經C肝感染過，需加驗C肝病毒量，若仍有C肝病毒，請接受C肝抗病毒藥物，治癒成功率達97%。</td></tr>',dat[44].includes("陽性")?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">C型肝炎</td></tr>',reportcontent+="</table></div>",reportcontent+='<div class="page-break2"></div><div class="page-break"></div>',reportcontent+='<div class="suggestion_title">彰化縣'+clinicname+"整合式篩檢衛教單(2/2)</div>",reportcontent+='<div><table class="suggestion_table1"><tr><td>整篩編號：'+dat[0]+"</td><td>姓名："+dat[2]+"</td></tr></table></div>",reportcontent+='<div><table class="suggestion_table2"><tr><th></th><th>項目</th><th>說明</th></tr>',1*dat[41]>=9?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">甲型胎兒蛋白<br>偏高</td><td>甲型胎兒蛋白(α-Fetoprotein)是一種α-1球蛋白，由胎兒的卵黃囊、腸胃道及肝臟分泌，成人則多由肝臟分泌，許多肝病皆可能伴隨甲型胎兒蛋白升高，80-90%的肝細胞癌病人血清中甲型胎兒蛋白有升高現象，檢查結果偏高建議至肝膽腸胃科接受腹部超音波檢查。</td></tr>',"陽性"==dat[59]?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">幽門桿菌抗原</td><td>若為陽性，表示疑似胃幽門螺旋桿菌感染，可能導致胃腸道出血、穿孔等併發症，嚴重者可能導致胃癌。建議胃鏡檢查，並接受除菌治療。</td></tr>',"陽性"==dat[60]?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">胃蛋白酶</td><td>若為陽性，表示您可能有萎縮性胃炎，胃酸分泌下降，建議接受胃鏡檢查，日常生活應減少鹹及醃製的食物、避免過度飲酒、戒菸，多吃新鮮蔬果。</td></tr>',"未作"==dat[53]?(t0="□",t1="無建議"):""==dat[54]?(t0="■",t1="檢查結果為"+dat[53]+"。"):(t0="■",t1="檢查結果為"+dat[53]+"，建議至"+dat[54]+"門診追蹤諮詢。"),reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">胸部X光</td><td>'+t1+"</td></tr>","陽性"==dat[56]?t0="■":t0="□",reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">糞便潛血</td><td>若為陽性，屬癌前病變及大腸直腸癌高危險群，建議儘快進行大腸鏡檢查。</td></tr>',"女"==dat[5]?""==dat[57]?(t0="□",t1="30歲以上婦女建議美田執行子宮頸抹片檢查。"):(t0="■",papcode=dat[58],["1","2","3"].includes(dat[58])?t1=dat[57]+"檢查結果為"+papcodelist[papcode]+"，為正常發現。":"21"==dat[58]?t1=dat[57]+"檢查結果為"+papcodelist[papcode]+"，請回診"+dat[57]+"再次抹片。":t1=dat[57]+"檢查結果為"+papcodelist[papcode]+"，為異常發現，請至婦產科門診追蹤。"):(t0="□",t1="男性不須做抹片"),reportcontent+='<tr><td style="text-align: center;">'+t0+'</td><td style="text-align: center;">子宮頸抹片</td><td>'+t1+"<br>子宮頸抹片篩檢結果準確率非100%，如發現任何異常情形或不適之狀況，建議請至婦產科就醫。</td></tr>",reportcontent+='<tr><td style="text-align: center;">□</td><td style="text-align: center;">其他</td><td><br><br><br><br></td></tr></table></div>',reportcontent+="<br><br>",reportcontent+='<div class="suggestion_title" style="text-align: left;">若有其他疑問歡迎諮詢</div>',reportcontent+='<div class="suggestion_title" style="text-align: left;">'+clinicname+"服務時間如下</div>",reportcontent+=addopdtable(),reportcontent+='<div class="suggestion_title" style="text-align: left;">'+clinicname+" 電話:"+clinicphone+"</div>",reportcontent+='<div class="suggestion_title" style="text-align: left;">'+clinicname+" 地址:"+clinicaddress+"</div>",reportcontent+='<div class="page-break2"></div><div class="page-break"></div>'),document.getElementById("checksmoke").checked&&"有"==dat[22]&&(reportcontent+=generatequitsmoke()),document.getElementById("checktransfer").checked&&(transGI={S:"",P:"",T:"■肝膽腸胃科　　□婦產科　　　□心臟科<br>□大腸直腸外科　□乳房外科　　□骨科<br>□腎臟科　　　　□胸腔科　　　□其他:________"},transCV={S:"",P:"",T:"□肝膽腸胃科　　□婦產科　　　■心臟科<br>□大腸直腸外科　□乳房外科　　□骨科<br>□腎臟科　　　　□胸腔科　　　□其他:________"},transCM={S:"",P:"",T:"□肝膽腸胃科　　□婦產科　　　□心臟科<br>□大腸直腸外科　□乳房外科　　□骨科<br>□腎臟科　　　　■胸腔科　　　□其他:________"},transNEP={S:"",P:"",T:"□肝膽腸胃科　　□婦產科　　　□心臟科<br>□大腸直腸外科　□乳房外科　　□骨科<br>■腎臟科　　　　□胸腔科　　　□其他:________"},transORT={S:"",P:"",T:"□肝膽腸胃科　　□婦產科　　　□心臟科<br>□大腸直腸外科　□乳房外科　　■骨科<br>□腎臟科　　　　□胸腔科　　　□其他:________"},transGYN={S:"",P:"",T:"□肝膽腸胃科　　■婦產科　　　□心臟科<br>□大腸直腸外科　□乳房外科　　□骨科<br>□腎臟科　　　　□胸腔科　　　□其他:________"},(1*dat[39]>80||1*dat[40]>80)&&(transGI.S+="肝功能異常，GOT:"+dat[39]+"IU/L,GPT:"+dat[40]+"IU/L，",transGI.P+="進一步檢查及治療"),dat[42].includes("陽性")&&(transGI.S+="B型肝炎表面抗原"+dat[42]+"，",transGI.P+="腹部超音波檢查"),""!=dat[66]&&"未操作"!=dat[66]&&"Target not detected"!=dat[66]&&(transGI.S+="HBV viral load: "+dat[66]+" IU/mL，",transGI.P+="腹部超音波檢查進一步檢查及治療"),dat[44].includes("陽性")&&(transGI.S+="C型肝炎表面抗原"+dat[44]+"，",transGI.P+="腹部超音波檢查"),1*dat[41]>9&&(transGI.S+="甲型胎兒蛋白偏高，"+dat[41]+"ng/mL，",transGI.P+="進一步檢查及治療"),dat[56].includes("陽性")&&(transGI.S+="FOBT"+dat[56]+"，",transGI.P+="大腸鏡檢查"),dat[59].includes("陽性")&&(transGI.S+="胃幽門桿菌"+dat[59]+"，",transGI.P+="胃鏡檢查除菌治療"),dat[60].includes("陽性")&&(transGI.S+="胃蛋白酶原檢驗結果"+dat[60]+"，PG I:"+dat[61]+"ng/mL，PG I/II:"+dat[62]+"，",transGI.P+="胃鏡檢查"),dat[54].includes("腸胃科")&&(transGI.S+="胸部X光檢查報告"+dat[53]+"，",transGI.P+="進一步檢查及治療"),""!=transGI.S&&(transGI.S+="煩請醫師診治",transGI.S="個案於"+dat[6]+"參加彰化縣衛生局整合式篩檢，發現"+transGI.S,reportcontent+=generatetransfer(transGI),transGI.S.includes("胃幽門桿菌")&&(reportcontent+=generatetransferHP())),dat[54].includes("心臟科")&&(transCV.S+="胸部X光檢查報告"+dat[53]+"，",transCV.P+="進一步檢查及治療"),""!=transCV.S&&(transCV.S+="煩請醫師診治",transCV.S="個案於"+dat[6]+"參加彰化縣衛生局整合式篩檢，發現"+transCV.S,reportcontent+=generatetransfer(transCV)),dat[54].includes("胸腔內科")&&(transCM.S+="胸部X光檢查報告"+dat[53]+"，",transCM.P+="進一步檢查及治療"),""!=transCM.S&&(transCM.S+="煩請醫師診治",transCM.S="個案於"+dat[6]+"參加彰化縣衛生局整合式篩檢，發現"+transCM.S,reportcontent+=generatetransfer(transCM)),dat[54].includes("骨科")&&(transORT.S+="胸部X光檢查報告"+dat[53]+"，",transORT.P+="進一步檢查及治療"),""!=transORT.S&&(transORT.S+="煩請醫師診治",transORT.S="個案於"+dat[6]+"參加彰化縣衛生局整合式篩檢，發現"+transORT.S,reportcontent+=generatetransfer(transORT)),["第4期","第5期"].includes(dat[51])&&(transNEP.S+="腎功能異常，Creatinine:"+dat[46]+"mg/dL,eGFR:"+dat[47]+"ml/min/1.73m^2，UPCR:"+dat[50]+"mg/g，",transNEP.P+="進一步檢查及治療"),""!=transNEP.S&&(transNEP.S+="煩請醫師診治",transNEP.S="個案於"+dat[6]+"參加彰化縣衛生局整合式篩檢，發現"+transNEP.S,reportcontent+=generatetransfer(transNEP)),1*dat[58]>3&&(papcode=dat[58],transGYN.S+=dat[57]+"醫師執行子宮頸抹片，結果為"+papcodelist[papcode]+"，",transGYN.P+="進一步檢查及治療"),""!=transGYN.S&&(transGYN.S+="煩請醫師診治",transGYN.S="個案於"+dat[6]+"參加彰化縣衛生局整合式篩檢，發現"+transGYN.S,reportcontent+=generatetransfer(transGYN)));reportcontent+="</body>",reportcontent+='<script>document.addEventListener("DOMContentLoaded", function() {var cells = document.querySelectorAll("table td");cells.forEach(function(cell) { if (cell.textContent.includes("*") || cell.textContent.includes("↑")) {cell.classList.add("highlightupper");} else if (cell.textContent.includes("↓")){cell.classList.add("highlightlower");}});});<\/script>',reportcontent,downloadelement=document.createElement("a"),downloadelement.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(reportcontent)),filename=clinicname+"整篩報告_"+document.getElementById("startnum").value+"_"+document.getElementById("endnum").value+".html",downloadelement.setAttribute("download",filename),downloadelement.text=filename,document.getElementById("downloadarea").appendChild(downloadelement),document.getElementById("downloadarea").appendChild(document.createElement("br"))}function addtitle(t){return retv="<!DOCTYPE html><html><head><title>"+t,retv+="</title><style>@media print{html, body{width: 210mm; min-height: 297mm; margin: 0; padding: 0;} .page-break{display: block; page-break-after: always;}.page-break2{display: none;}*{-webkit-print-color-adjust: exact;} } @media screen{body{background: white; width: 210mm; min-height: 297mm; margin: 20px auto; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);} }.page-break2{height: 10px;background-color: rgba(0, 0, 0, 0.5);}.checklist_title{font-size: 24px;font-family: '標楷體' ;font-weight: 400;text-align: center;} .checklist_table_1{border-collapse: collapse; width: 95%;margin-left: auto;margin-right: auto;} .checklist_table_1 th, .checklist_table_1 td{border: 1px solid transparent;font-family: '標楷體' ;font-size: 20px;}.checklist_table_2{border-collapse: collapse; width: 95%;table-layout: fixed;margin-left: auto;margin-right: auto;} .checklist_table_2 th, .checklist_table_2 td{border: 1px solid;font-family: '標楷體' ;font-size: 20px;}.checklist_table_2 th:nth-child(1){width: 20%;}.checklist_table_2 td:nth-child(1){text-align: center;}.checklist_table_2 th:nth-child(2){width: 30%;}.checklist_table_2 th:nth-child(3){width: 20%;}.checklist_table_2 td:nth-child(3){text-align: center;}.checklist_table_2 th:nth-child(4){width: 30%;}.checklist_table_value{text-decoration: underline;}.checklist_table_3{border-collapse: collapse; width: 95%;table-layout: fixed;margin-left: auto;margin-right: auto;}.checklist_table_3 th, .checklist_table_3 td{border: 1px solid;font-family: '標楷體' ;font-size: 20px;}.checklist_table_3 td:nth-child(1){width: 10%;}.checklist_table_3 tdnth-child(2){width: 30%;}.checklist_table_3 tdnth-child(3){width: 60%;}.checklist_sign{font-size: 20px;font-family: '標楷體' ;text-align: center;}.checklist_uppertitle{font-size: 32px;font-family: '標楷體' ;font-weight: 400;background-color: #d0e7ff;}.checklist_middletitle{font-size: 70px;font-family: '標楷體' ;font-weight: 400;text-align: center;}.checklist_content{font-size: 32px;font-family: '標楷體' ;font-weight: 400;}.checklist_splitline{font-size: 32px;font-family: '標楷體' ;font-weight: 400;text-align: center;}.report_title{font-size: 20px;font-family: '標楷體' ;font-weight: 400;text-align: center;}.report_table{border-collapse: collapse; width: 95%;table-layout: fixed;margin-left: auto;margin-right: auto;} .report_table th, .report_table td{border: 1px transparent;font-family: '標楷體' ;font-size: 20px;}.report_table th:nth-child(1){width: 25%;}.report_table th:nth-child(2){width: 25%;}.report_table th:nth-child(3){width: 25%;}.report_table th:nth-child(4){width: 25%;}.report_table td:nth-child(3){text-align: center;}.report_table_underline{text-decoration: underline;text-align: center;}.report_table_title{font-size: 20px;font-family: '標楷體' ;font-weight: 400;padding: 2px;background-color: #BEBEBE;background-clip: content-box;text-align: center;}.report_table_subtitle{font-size: 20px;font-family: '標楷體' ;font-weight: 600;}.suggestion_title{font-size: 24px;font-family: '標楷體' ;font-weight: 700;text-align: center;}.suggestion_table1{border-collapse: collapse; width: 95%;table-layout: fixed;margin-left: auto;margin-right: auto;} .suggestion_table1 th, .suggestion_table1 td{border: 1px transparent;font-family: '標楷體' ;font-size: 20px;}.suggestion_table1 th:nth-child(1){width: 50%;}.suggestion_table1 th:nth-child(2){width: 50%;}.suggestion_table2{border-collapse: collapse; width: 95%;table-layout: fixed;margin-left: auto;margin-right: auto;} .suggestion_table2 th{border: 1px solid;font-family: '標楷體' ;font-size: 20px;font-weight: 600;text-align: center;}.suggestion_table2 td{border: 1px solid;font-family: '標楷體' ;font-size: 20px;}.suggestion_table2 th:nth-child(1){width: 5%;}.suggestion_table2 th:nth-child(2){width: 20%;}.suggestion_table2 th:nth-child(3){width: 75%;}.transfer_title{font-size: 24px;font-family: '標楷體' ;font-weight: 700;text-align: center;}.transfer_table1{border-collapse: collapse; width: 95%;table-layout: fixed;margin-left: auto;margin-right: auto;} .transfer_table1 th, .transfer_table1 td{border: 1px transparent;font-family: '標楷體' ;font-size: 20px;}.transfer_table1 td:nth-child(1){width: 50%;text-align: left;}.transfer_table1 td:nth-child(2){width: 50%;text-align: right;}.transfer_table2{border-collapse: collapse; width: 95%;table-layout: fixed;margin-left: auto;margin-right: auto;}.transfer_table2 th, .transfer_table2 td{border: 2px solid;font-family: '標楷體' ;font-size: 16px;text-align: center;table-layout: fixed;}.transHP_title{font-size: 24px;font-family: '標楷體' ;font-weight: 700;text-align: center;}.transHP_table{border: 2px solid; border-collapse: collapse; width: 95%;table-layout: fixed;margin-left: auto;margin-right: auto;}.transHP_table th, .transHP_table td{border: 1px transparent;font-family: '標楷體' ;font-size: 16px;}.transHP_end{width: 95%;font-size: 16px;font-family: '標楷體' ;font-weight: 700;text-align: left;margin-left: auto;margin-right: auto;} .quitsmoke_title{width: 95%; font-size: 40px; font-family: '標楷體' ;font-weight: 700;display: flex;align-items: center;justify-content: center;margin-left: auto; margin-right: auto;} .quitsmoke_content{font-size: 32px; font-family: '標楷體' ;} .quitsmoke_table{border-collapse: collapse; font-size: 24px; font-family: '標楷體' ;width: 90%; margin-left: auto; margin-right: auto;} .quitsmoke_table td{border: 2px solid;font-family: '標楷體' ;font-size: 24px; text-align: center;} .highlightupper {color: red; font-weight: 600;} .highlightlower {color: blue; font-weight: 600;}</style></head><body>\n\t",retv}function generatequitsmoke(){return retv="",retv+='<div class="quitsmoke_title"><img style="height:50px;" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAA0JCgsKCA0LCwsPDg0QFCEVFBISFCgdHhghMCoyMS8qLi00O0tANDhHOS0uQllCR05QVFVUMz9dY1xSYktTVFH/2wBDAQ4PDxQRFCcVFSdRNi42UVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVH/wAARCAGkAhwDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD06iiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoopDQAtIajmnjgiMkrhEHUk1ymqeM0Vmj0+Pf/ANNG6flUyko7m1HD1KztBHVTTxQIXlkVFHdjise68WaVbkhZTKw/uDNcDe311fSF7mZpD6E8D6Cq9YOv2PZo5QrXqM6+fxxJu/cWY2/7bVUfxpqTN8kUCj0IzXN0Vn7Wfc7o5dh19k6WPxrqC/6yCFvpxV228bqTi5tCvuhzXG0UKrJCll2Hl9mx6Xa+JtKucAXIjb0cYrWSRXG5WDKe4rx6r+n6zf6cR5E52f3G5FaRr9zgrZRpemz1WiuX0jxdb3REV4vkSf3s/Kf8K6ZWDAFTkHvW8ZKWx49WjOk+WasOooFFUZBRRRQAUUUUAFFFFABRRRQAUUUUAFFFJQAtFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRmkJxQAZqhquq22mW5lncZ/hQdWNZ+veJINNVoYcSXJHAHRfrXA3l3Pe3BnuZC8h7+n0rKdRR2PSweAlW96eiLmsa1datKfMJSEH5Yx/Ws2iiuNtyd2fTU6UaUeWC0CiiikaBRRRQIKKKKACiiigYVu6F4kuNNZYZyZrb06sv0rCoqoycXdGNahCtHlmj1uzvIL23We3kDo3cVYBzXlGm6ndaZP5lu/B6ofutXoWi67a6pF8h2TD70bda64VFI+YxeBnQd1qjWopM0ua1OAKKKKACiiigAooooAKKKKACkIpaKACijFJigBc0UgFKKACiiigAooooAKKKKACiiigAooooAKKKKACkpaKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACjNJVa+vrewtzPcyBEH60DScnZE7uqKWYgAdzXG694rLbrbTm45DS/wCFZWu+IrnVGMUZMVsDwoPLfWsWuWpW6RPeweW29+r9wElmySST1J70UUVge4lbYKKKKQBRRRQAUUUUAFFFFABRRRQAUUUUAFPilkhlWWJyjqchh1FMopiaTVmdzoHiqO52W18RHMeA/QN/9eupBBGQcivHa6PQfE8tiFt7zMlv0DfxL/iK6KdbpI8HGZZa86P3HoNFQW1zDcxLLDIHRhkEGpxXSeI007MKKKKBBRRRQAUUUUAFFFFABRRRQAUGiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiig0AFITSFsCuX8QeKUts21iVkmxhn7L/AImplJRV2a0qM60uWCNLW9dttKiIJDzkfLGDyfr6V59qWpXOp3BmuHJ/uoDwoqvLLJPIZZXZ3bqzHmmVyTqOWnQ+nwmBhQV3rIKKKKyPQCiiigAooooEFFFFABRRRQAUUUUDCiiigQUUUUAFFFFABRRRQM0NJ1e60qYPC2YyfmjPQ/4V6FpOsW2qQ74Ww4+8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"><span>戒菸建議書</span></div>',retv+='<br><br><br><br><br><div class="quitsmoke_content">',retv+="<span>親愛的"+dat[2]+"<br><br>　　　　為了您的健康強烈建議您<br><br></span>",retv+='<span style="font-size: 140px; font-weight: 700;">　　戒菸!<br></span><span><br>我們有提供以下服務供您參考<br></span><span style="font-weight: 700;">1. 戒菸門診: 衛生所門診表如下<br></span>',retv+=addopdtable(),retv+='<span style="font-weight: 700;">2. 戒菸專線服務中心: 0800-63-63-63<br></span><span style="font-weight: 700;">3. 戒菸班: 請洽和美鎮衛生所 電話：04-7062455<br></span></div><div class="page-break2"></div><div class="page-break"></div>',retv}function generatetransfer(t){return ret='<br><div class="transfer_title">全民健康保險'+clinicname+"轉診單(轉診至________________)</div>",ret+='<div><table class="transfer_table1"><tr><td>保險醫事服務機構代號：'+cliniccode+"</td><td>整篩編號："+dat[0]+"</td><tr></table>",ret+='<table class="transfer_table2"><tr><td rowspan="10" style="width: 3%">原<br>診<br>治<br>醫<br>院<br>診<br>所</td><td rowspan="4" style="width: 5%">保險<br>對象<br>基本<br>資料</td><td colspan="2" style="width: 25%">姓名</td><td colspan="2" style="width: 17%">性別</td><td colspan="2" style="width: 25%">生日</td><td colspan="2" style="width: 25%">身分證號</td></tr>',ret+='<tr><td colspan="2">'+dat[2]+'</td><td colspan="2">'+dat[5]+'</td><td colspan="2">'+dat[3]+'</td><td colspan="2">'+dat[1]+"</td></tr>",ret+='<tr><td colspan="3">聯絡人</td><td colspan="3">連絡電話</td><td colspan="2">聯絡地址</td></tr>',""!=dat[9]?t0=dat[9]:t0=dat[8],ret+='<tr><td colspan="3">'+dat[2]+'</td><td colspan="3">'+t0+'</td><td colspan="2" style="text-align: left;">'+dat[10]+"</td></tr>",ret+='<tr><td><br>病<br>歷<br>摘<br>要<br><br></td><td colspan="8" style="text-align: left; vertical-align: top;">'+t.S+"</td></tr>",t.P.includes("胃鏡檢查")?t1="■":t1="□",t.P.includes("大腸鏡檢查")?t2="■":t2="□",t.P.includes("腹部超音波檢查")?t3="■":t3="□",t.P.includes("除菌治療")?t4="■":t4="□",ret+='<tr><td>轉診<br>目的</td><td colspan="8" style="text-align: left;">■進一步檢查及治療<br>　　'+t1+"胃鏡檢查　"+t2+"大腸鏡檢查　"+t3+"腹部超音波檢查　"+t4+"除菌治療</td></tr>",ret+='<tr><td>院所<br>住址</td><td colspan="5" style="text-align: left;">'+clinicaddress+'</td><td>傳真號碼:<br>電子信箱:</td><td colspan="2"></td></tr>',ret+="<tr><td>診治<br>醫師</td><td>姓名</td><td>"+doctorname+"</td><td>科別</td><td>"+doctorsp+"</td><td>電話</td><td>"+clinicphone+"</td><td>醫師簽章</td><td></td></tr>",ret+='<tr><td colspan="2">轉診<br>日期</td><td colspan="3"> '+explaintime.split("-")[0]+" 年 "+explaintime.split("-")[1]+" 月 "+explaintime.split("-")[2]+' 日</td><td>有效<br>期限</td><td colspan="3">'+expiretime.split("-")[0]+" 年 "+expiretime.split("-")[1]+" 月 "+expiretime.split("-")[2]+" 日</td></tr>",ret+='<tr><td>建議轉診<br>院所科別</td><td colspan="5"  style="text-align: left;">'+t.T+'<br></td><td>轉診院所地址及專線電話</td><td colspan="2"></td></tr>',ret+='<tr><td rowspan="4"><br>接<br>受<br>轉<br>診<br>醫<br>院<br>診<br>所<br><br></td><td>處<br>理<br>情<br>形</td><td colspan="8" style="text-align: left;">1.　已安排本院　　　　　　科門診治療中<br>2.　已予適當處理並轉回原院所，建議事項如下<br><br><br><br><br><br></td></tr><tr><td>治<br>療<br>摘<br>要</td>\t\t\t\t<td colspan="8" style="text-align: left;">1.　主診斷ICD-10-CM/PCS：　　　　　　　　　　病名：<br><br><br>2.　治療藥物或手術名稱<br><br><br><br><br><br><br><br>3. 　輔助診斷之檢查結果<br><br><br><br><br><br><br><br></td></tr><tr><td>院所<br>名稱</td><td colspan="3" style="text-align: left;"></td><td colspan="2">電話或傳真：<br>電子信箱：</td><td colspan="3" style="text-align: left;"></td></tr><tr><td>診治<br>醫師</td><td>姓名</td><td></td><td>科別</td><td></td><td>醫師<br>簽章</td><td></td><td>回覆<br>日期</td><td></td></tr></table></div>',ret+='<div class="page-break2"></div><div class="page-break"></div>',ret}function generatetransferHP(){return ret='<div class="transHP_title">彰化縣　健康篩檢服務　糞便幽門桿菌檢查　轉診紀錄單</div><div><table class="transHP_table">',ret+='<tr><td style="width:5%">一、</td><td style="width:30%">個案基本資料:</td><td style="width:30%"></td><td style="width:35%"></td></tr>',ret+="<tr><td></td><td>姓名:"+dat[2]+"("+dat[5]+")</td><td>生日:"+dat[3]+"</td><td>整篩編號:"+dat[0]+"</td></tr>",ret+="<tr><td></td><td>身份證字號:"+dat[1]+"</td><td>電話:"+dat[8]+"</td><td>手機:"+dat[9]+"</td></tr>",ret+='<tr><td></td><td colspan="3">地址:'+dat[10]+"</td></tr>",ret+="<tr><td>二、</td><td>病歷摘要</td><td></td><td></td></tr>",ret+='<tr><td></td><td colspan="3">糞便幽門桿菌檢查日期： '+dat[6].substring(0,3)+" 年 "+dat[6].substring(3,5)+" 月 "+dat[6].substring(5,7)+" 日</td></tr>",ret+='<tr><td></td><td colspan="3">糞便幽門桿菌檢查結果：■陽性, 於治療後願意接受第2次篩檢　□是　□否</td></tr>',ret+='<tr style="border-bottom: 2px solid"><td></td><td colspan="3">照會重點：請依臨床專業給予　■衛教諮詢　■進一步檢查治療　□繼續觀察</td></tr>',ret+='<tr><td colspan="2">轉診衛生所： '+clinicname+"</td><td>電話："+clinicphone+"</td><td>傳真：</td></tr>",ret+='<tr><td colspan="4">地址：'+clinicaddress+'</td></tr><tr><td colspan="4">保險醫事服務機構代號：'+cliniccode+'</td></tr><tr><td colspan="4">建議轉診科別：<span style="font-weight: 700;">肝膽腸胃科</span></td></tr>',ret+='<tr style="border-bottom: 2px solid"><td colspan="2">聯絡人：<br><br></td><td>醫師簽章：<br><br></td><td>轉診日期：<br><br></td></tr><tr><td colspan="3">三、轉診後處理(由確診及治療醫院填寫)</td><td style="border-left: 2px solid"></td></tr><tr><td style="text-align: right; ">1.<br><br></td><td colspan="2">請依專業以及健保規範判斷，協助諮詢說明胃幽門桿菌感染的臨床意義與對健康的可能影響</td><td style="border-left: 2px solid"></td></tr><tr><td style="text-align: right; ">2.</td><td colspan="2">處方</td><td style="border-left: 2px solid">就診院所：____________________</td></tr><tr><td></td><td colspan="2">（1）依病情或健保規範需進一步檢查做胃鏡檢查</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　結果：□是</td><td style="border-left: 2px solid">就診科別：____________________</td></tr><tr><td></td><td colspan="2">　　　　□否；請說明：____________________</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　□病人拒絕</td><td style="border-left: 2px solid">醫師姓名：____________________</td></tr><tr><td></td><td colspan="2">（2）上消化道內視鏡</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　結果：□正常</td><td style="border-left: 2px solid">病 歷 號：____________________</td></tr><tr><td></td><td colspan="2">　　　　□胃炎；位置範圍：____________________________</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　□胃潰瘍；位置範圍：__________________________</td><td style="border-left: 2px solid">診察日期：_____年_____月______日</td></tr><tr><td></td><td colspan="2">　　　　□十二指腸潰瘍；位置範圍：____________________</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　□胃食道逆流；程度：__________________________</td><td style="border-left: 2px solid">回覆日期：_____年_____月______日</td></tr><tr><td></td><td colspan="2">　　　　□胃腫瘤；位置範圍：__________________________</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　□切片</td><td style="border-left: 2px solid;font-weight: 700;">四、醫師建議</td></tr><tr><td></td><td colspan="2">　　　　　切片結果：__________________________________</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　□其他：______________________________________</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">（3）上消化道攝影</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　結果：□正常</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　□異常；請說明：______________________________</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">（4）口服藥</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　結果：□無　□病人拒服　□其他用藥，藥名____________</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　□公費除菌藥(一線)</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　　　□PPI</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　　　□Amoxicillin 1000mgBID</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　　　□Metronidazole 250mgBID</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　　　□Clarithromycin 500mgBID</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　□公費除菌藥(二線)</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　　　□PPI□Amoxicillin□Levofloxacin</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　　　□PPI□Bismuth□Tetracycline□Metronidazole</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　□健保</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　□自費，藥名__________________________________</td><td style="border-left: 2px solid"></td></tr><tr><td></td><td colspan="2">　　　　服用週期□5天　□10天　□其他_________________</td><td style="border-left: 2px solid"></td></tr></table><div class="transHP_end"><span>備註：轉診單填妥後請於個案確診日隔天 中午前回傳至衛生所。<br>　　　轉診紀錄單正本及胃鏡紙本報告單，請於個案確診後1周內寄回衛生所，感謝您。</span></div></div>',ret+='<div class="page-break2"></div><div class="page-break"></div>',ret}function addcomment(t,e,d,l){return retvalue=t,0!=e&&1*t>e&&(retvalue=t+"↑"),0!=d&&1*t<d&&(retvalue=t+"↓"),l&&isNaN(1*t)&&(retvalue=t+"*"),retvalue}function checkbasic(){return errmsg="",cn=document.getElementById("clinicname").value,cc=document.getElementById("cliniccode").value,cp=document.getElementById("clinicphone").value,ca=document.getElementById("clinicaddress").value,dn=document.getElementById("doctorname").value,ds=document.getElementById("doctorsp").value,etv1=document.getElementById("explaindate").value,etv2=document.getElementById("expiredate").value,amtime=document.getElementById("amtime").value,pmtime=document.getElementById("pmtime").value,opdam1=document.getElementById("opdam1").value,opdpm1=document.getElementById("opdpm1").value,opdam2=document.getElementById("opdam2").value,opdpm2=document.getElementById("opdpm2").value,opdam3=document.getElementById("opdam3").value,opdpm3=document.getElementById("opdpm3").value,opdam4=document.getElementById("opdam4").value,opdpm4=document.getElementById("opdpm4").value,opdam5=document.getElementById("opdam5").value,opdpm5=document.getElementById("opdpm5").value,""==cn&&(errmsg+="未輸入衛生所名稱\n"),""==cc&&(errmsg+="未輸入衛生所代碼\n"),""==cp&&(errmsg+="未輸入衛生所代碼\n"),""==ca&&(errmsg+="未輸入衛生所地址\n"),""==dn&&(errmsg+="未輸入醫師姓名\n"),""==ds&&(errmsg+="未輸入醫師專科別\n"),""==etv1&&(errmsg+="未輸入二階時間\n"),""==etv2&&(errmsg+="未輸入轉診單過期時間\n"),""==amtime&&(errmsg+="未輸入上午門診時間\n"),""==pmtime&&(errmsg+="未輸入下午門診時間\n"),""==opdam1&&(errmsg+="未輸入星期一上午門診內容\n"),""==opdpm1&&(errmsg+="未輸入星期一下午門診內容\n"),""==opdam2&&(errmsg+="未輸入星期二上午門診內容\n"),""==opdpm2&&(errmsg+="未輸入星期二下午門診內容\n"),""==opdam3&&(errmsg+="未輸入星期三上午門診內容\n"),""==opdpm3&&(errmsg+="未輸入星期三下午門診內容\n"),""==opdam4&&(errmsg+="未輸入星期四上午門診內容\n"),""==opdpm4&&(errmsg+="未輸入星期四下午門診內容\n"),""==opdam5&&(errmsg+="未輸入星期五上午門診內容\n"),""==opdpm5&&(errmsg+="未輸入星期五下午門診內容\n"),errmsg}function exportbasic(){errmsg=checkbasic(),""==errmsg?(tempobj={},tempobj.clinicname=cn,tempobj.cliniccode=cc,tempobj.clinicphone=cp,tempobj.clinicaddress=ca,tempobj.doctorname=dn,tempobj.doctorsp=ds,tempobj.explaindate=etv1,tempobj.expiredate=etv2,tempobj.amtime=amtime,tempobj.pmtime=pmtime,tempobj.opdam1=opdam1,tempobj.opdpm1=opdpm1,tempobj.opdam2=opdam2,tempobj.opdpm2=opdpm2,tempobj.opdam3=opdam3,tempobj.opdpm3=opdpm3,tempobj.opdam4=opdam4,tempobj.opdpm4=opdpm4,tempobj.opdam5=opdam5,tempobj.opdpm5=opdpm5,download(cn+"_"+etv1+"_基本設定.txt",JSON.stringify(tempobj))):alert(errmsg)}function download(t,e){var d=document.createElement("a");d.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),d.setAttribute("download",t),d.style.display="none",document.body.appendChild(d),d.click(),document.body.removeChild(d)}function cleanbasic(){document.getElementById("clinicname").value="",document.getElementById("cliniccode").value="",document.getElementById("clinicphone").value="",document.getElementById("clinicaddress").value="",document.getElementById("doctorname").value="",document.getElementById("doctorsp").value="",document.getElementById("explaindate").value=(new Date).toISOString().split("T")[0],document.getElementById("explaindate").dispatchEvent(new Event("change",{bubbles:!0})),document.getElementById("amtime").value="",document.getElementById("pmtime").value="",document.getElementById("opdam1").value="",document.getElementById("opdpm1").value="",document.getElementById("opdam2").value="",document.getElementById("opdpm2").value="",document.getElementById("opdam3").value="",document.getElementById("opdpm3").value="",document.getElementById("opdam4").value="",document.getElementById("opdpm4").value="",document.getElementById("opdam5").value="",document.getElementById("opdpm5").value=""}function showopdlist(){opdlistcontent=addtitle("門診表"),opdlistcontent+=addopdtable(),opdlistcontent+="</body></html>",opdwindow=window.open("","_blank"),opdwindow.document.open(),opdwindow.document.write(opdlistcontent),opdwindow.document.close()}function addopdtable(){return amtime=document.getElementById("amtime").value,pmtime=document.getElementById("pmtime").value,opdam1=document.getElementById("opdam1").value,opdpm1=document.getElementById("opdpm1").value,opdam2=document.getElementById("opdam2").value,opdpm2=document.getElementById("opdpm2").value,opdam3=document.getElementById("opdam3").value,opdpm3=document.getElementById("opdpm3").value,opdam4=document.getElementById("opdam4").value,opdpm4=document.getElementById("opdpm4").value,opdam5=document.getElementById("opdam5").value,opdpm5=document.getElementById("opdpm5").value,amtime=amtime.replaceAll("~","<br>~<br>"),amtime=amtime.replaceAll("-","<br>~<br>"),pmtime=pmtime.replaceAll("~","<br>~<br>"),pmtime=pmtime.replaceAll("-","<br>~<br>"),opdam1=opdam1.replaceAll("\n","<br>"),opdam2=opdam2.replaceAll("\n","<br>"),opdam3=opdam3.replaceAll("\n","<br>"),opdam4=opdam4.replaceAll("\n","<br>"),opdam5=opdam5.replaceAll("\n","<br>"),opdpm1=opdpm1.replaceAll("\n","<br>"),opdpm2=opdpm2.replaceAll("\n","<br>"),opdpm3=opdpm3.replaceAll("\n","<br>"),opdpm4=opdpm4.replaceAll("\n","<br>"),opdpm5=opdpm5.replaceAll("\n","<br>"),retopdtable="",retopdtable+='<table class="quitsmoke_table"><tr><td style="width:15%">時段</td><td style="width:17%">星期一</td><td style="width:17%">星期二</td><td style="width:17%">星期三</td><td style="width:17%">星期四</td><td style="width:17%">星期五</td></tr>',retopdtable+="<tr><td>上午<br>"+amtime+"</td><td>"+opdam1+"</td><td>"+opdam2+"</td><td>"+opdam3+"</td><td>"+opdam4+"</td><td>"+opdam5+"</td></tr>",retopdtable+="<tr><td>下午<br>"+pmtime+"</td><td>"+opdpm1+"</td><td>"+opdpm2+"</td><td>"+opdpm3+"</td><td>"+opdpm4+"</td><td>"+opdpm5+"</td></tr>",retopdtable+="</table>",retopdtable}function getxlsvalue(t){var e="";return t&&(e=t.v||""),e}importtxt.addEventListener("change",function(t){const e=t.target.files[0];if(e){const t=new FileReader;t.onload=function(t){const e=t.target.result;jcontent=JSON.parse(e),document.getElementById("clinicname").value=jcontent.clinicname,document.getElementById("cliniccode").value=jcontent.cliniccode,document.getElementById("clinicphone").value=jcontent.clinicphone,document.getElementById("clinicaddress").value=jcontent.clinicaddress,document.getElementById("doctorname").value=jcontent.doctorname,document.getElementById("doctorsp").value=jcontent.doctorsp,document.getElementById("explaindate").value=jcontent.explaindate,document.getElementById("expiredate").value=jcontent.expiredate,document.getElementById("amtime").value=jcontent.amtime,document.getElementById("pmtime").value=jcontent.pmtime,document.getElementById("opdam1").value=jcontent.opdam1,document.getElementById("opdpm1").value=jcontent.opdpm1,document.getElementById("opdam2").value=jcontent.opdam2,document.getElementById("opdpm2").value=jcontent.opdpm2,document.getElementById("opdam3").value=jcontent.opdam3,document.getElementById("opdpm3").value=jcontent.opdpm3,document.getElementById("opdam4").value=jcontent.opdam4,document.getElementById("opdpm4").value=jcontent.opdpm4,document.getElementById("opdam5").value=jcontent.opdam5,document.getElementById("opdpm5").value=jcontent.opdpm5},t.readAsText(e),importtxt.value=""}else alert("無選擇文件")}),startnum=document.getElementById("startnum"),endnum=document.getElementById("endnum"),startnum.addEventListener("change",function(t){sv=startnum.value,isNaN(1*sv)||1*sv<1?(startnum.value="001",alert("請輸入數值")):endnum.value=sv}),endnum.addEventListener("change",function(t){sv=startnum.value,ev=endnum.value,1*ev<1*sv&&(endnum.value=startnum.value,alert("結束編號不可小於起始編號"))}),et1=document.getElementById("explaindate"),et2=document.getElementById("expiredate"),et1.value=(new Date).toISOString().split("T")[0],et1.addEventListener("change",function(t){let e=new Date(et1.value);e.setDate(e.getDate()+90),et2.value=e.toISOString().split("T")[0]}),et1.dispatchEvent(new Event("change",{bubbles:!0})),cc="ex:門診\n抽血",cc2="ex:門診\n小兒疫苗",cc3="ex:休診",cc4="ex:門診",cc5="ex:門診\n卡介苗\n僅第一周",document.getElementById("opdam1").placeholder=cc,document.getElementById("opdpm1").placeholder=cc4,document.getElementById("opdam2").placeholder=cc2,document.getElementById("opdpm2").placeholder=cc5,document.getElementById("opdam3").placeholder=cc,document.getElementById("opdpm3").placeholder=cc3,document.getElementById("opdam4").placeholder=cc4,document.getElementById("opdpm4").placeholder=cc4,document.getElementById("opdam5").placeholder=cc,document.getElementById("opdpm5").placeholder=cc4,document.getElementById("checkall").addEventListener("click",function(t){document.getElementById("checkchecklist").checked=document.getElementById("checkall").checked,document.getElementById("checkreport").checked=document.getElementById("checkall").checked,document.getElementById("checksmoke").checked=document.getElementById("checkall").checked,document.getElementById("checktransfer").checked=document.getElementById("checkall").checked}),papcodelist={1:"(1)正常",2:"(2)發炎",3:"(3)萎縮性變化",4:"(4)非典型扁平上皮細胞病變 (ASC-US)",5:"(5)非典型腺體細胞病變 (AGC)",6:"(6)細胞輕度病變併有空洞細胞 (CIN 1)",7:"(7)細胞輕度病變無空洞細胞 (CIN 1)",8:"(8)細胞中度病變 (CIN 2)",9:"(9)細胞重度病變 (CIN 3)",10:"(10)上皮原位癌 (CIN 3 / CIS)",11:"(11)子宮頸扁平上皮細胞癌 (SCC)",12:"(12)子宮頸腺體細胞癌 (Adenocarcinoma)",13:"(13)其他惡性腫瘤",14:"(14)其他",15:"(15)非典型腺體細胞疑惡性 (AGC-favor neoplasm, AGC-FN)",16:"(16)非典型扁平上皮細胞疑高階病變 (ASC favor HSIL, ASC-H)",17:"(17)細胞異常疑高階病變",18:"(18)原位子宮頸腺癌 (AIS)",21:"難以判讀"};
